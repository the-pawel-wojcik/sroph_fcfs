from dataclasses import dataclass
import matplotlib.pyplot as plt
from matplotlib.axes import Axes


@dataclass
class Irrep:
    letter: str
    subscript: str


@dataclass
class FCFs:
    mulliken_id: int
    irrep: Irrep
    nu_cm: float
    fcfs: list[float]
    dQ: float


fcfs_nu12 = FCFs(
    mulliken_id=12,
    irrep=Irrep(letter='a', subscript='1'),
    nu_cm=239,
    dQ=0.119,
    fcfs= [
        abs(float(fcf)) for fcf in 
        """9.7499e-01   2.2045e-01   2.7970e-02   1.7515e-03  -5.7635e-05
        -2.2362e-05  -1.5089e-06   8.9556e-08   2.2056e-08   7.7121e-10
        -1.6570e-10 -1.9057e-11   4.3047e-13   2.2023e-13   8.9306e-15
        -1.7242e-15  -1.8873e-16 7.3048e-18   2.3250e-18   4.5565e-20
        -2.1614e-20  -1.5358e-21   1.4884e-22 2.2870e-23  -4.8228e-25
        -2.5830e-25  -6.4627e-27   2.3940e-27   1.6928e-28 -1.7720e-29
        -2.4880e-30   8.2939e-32   2.9161e-32   2.8578e-34  -2.9213e-34
        -1.4138e-35   2.5073e-36   2.4038e-37  -1.7295e-38  -3.1305e-39
        6.8321e-41 3.5047e-41   5.1031e-43  -3.4797e-43  -1.7185e-44
        3.0522e-45   2.8115e-46 -2.2597e-47  -3.6737e-48   1.1738e-49
        4.2137e-50   1.0746e-52  -4.3705e-52 -1.4697e-53   4.1176e-54
        2.7924e-55  -3.4631e-56  -3.9583e-57   2.4482e-58 4.8628e-59
        -1.1428e-60""".split()
        ]
)


fcfs_nu11 = FCFs(
    mulliken_id=11,
    irrep=Irrep(letter='a', subscript='1'),
    nu_cm=608,
    dQ=-0.0205,
    fcfs= [
        abs(float(fcf)) for fcf in 
        """9.9809e-01   6.1802e-02   1.4001e-04  -1.7846e-04  -5.9660e-06
        4.1513e-07   3.0295e-08  -6.8833e-10  -1.1810e-10  -7.8144e-14
        4.0583e-13 7.8475e-15  -1.2724e-15  -4.9264e-17   3.6426e-18
        2.3128e-19  -9.2429e-21 -9.5457e-22   1.8726e-23   3.6441e-24
        -1.5905e-26  -1.3145e-26  -1.1703e-28 4.5229e-29   9.8820e-31
        -1.4888e-31  -5.3311e-33   4.6765e-34   2.4506e-35 -1.3889e-36
        -1.0330e-37   3.8189e-39   4.1147e-40  -9.2374e-42  -1.5719e-42
        1.6649e-44   5.8071e-45  -5.9460e-49  -2.0839e-47  -2.0449e-49
        7.2812e-50 1.4385e-51  -2.4781e-52  -7.5089e-54   8.2060e-55
        3.4570e-56  -2.6353e-57 -1.4815e-58   8.1569e-60   6.0526e-61
        -2.4058e-62  -2.3875e-63   6.6125e-65 9.1605e-66  -1.6099e-67
        -3.4345e-68   2.9587e-70   1.2620e-70  -4.0351e-74 -4.5525e-73
        -3.4937e-75""".split()
    ]
)


fcfs_nu10 = FCFs(
    mulliken_id=10,
    irrep=Irrep(letter='a', subscript='1'),
    nu_cm=885,
    dQ=-0.0117,
    fcfs=[
        abs(float(fcf)) for fcf in 
        """9.9910e-01   4.2506e-02   6.2111e-04  -1.7050e-05  -8.6339e-07
        -2.2318e-09   6.9490e-10   1.3097e-11  -4.0806e-13  -1.7281e-14
        1.2785e-16   1.6978e-17   9.4569e-20  -1.4068e-20  -2.4479e-22
        9.9622e-24   3.2658e-25  -5.6266e-27  -3.5186e-28   1.6636e-30
        3.3506e-31   1.5994e-33  -2.9021e-34  -4.0306e-36   2.2945e-37
        5.6285e-39  -1.6248e-40  -6.4717e-42   9.6485e-44   6.6817e-45
        -3.6403e-47  -6.3967e-48  -1.4756e-50   5.7542e-51   5.5516e-53
        -4.8800e-54  -8.5557e-56   3.8823e-57   1.0538e-58  -2.8493e-60
        -1.1603e-61   1.8488e-63   1.1885e-64  -9.2978e-67  -1.1533e-67
        1.2440e-70   1.0696e-70   5.4921e-73  -9.5149e-74  -1.0843e-75
        8.1156e-77   1.4828e-78  -6.6065e-80  -1.7533e-81   5.0774e-83
        1.9084e-84  -3.5990e-86  -1.9636e-87   2.2241e-89   1.9355e-90
        -9.8996e-93""".split()
    ]
)


fcfs_nu9 = FCFs(
    mulliken_id=9,
    irrep=Irrep(letter='a', subscript='1'),
    nu_cm=1014,
    dQ=-0.0009,
    fcfs=[
        abs(float(fcf)) for fcf in 
        """9.9999e-01   3.4420e-03  -1.1017e-04  -6.9014e-07   1.4809e-08
        1.2629e-10  -2.0891e-12  -2.2321e-14   3.0048e-16   3.8730e-18
        -4.3577e-20  -6.6435e-22   6.3349e-24   1.1306e-25  -9.1947e-28
        -1.9131e-29   1.3280e-31   3.2225e-33  -1.9023e-35  -5.4090e-37
        2.6924e-39   9.0523e-41  -3.7460e-43  -1.5112e-44   5.0864e-47
        2.5175e-48  -6.6629e-51  -4.1861e-52   8.2466e-55   6.9491e-56
        -9.2268e-59  -1.1518e-59   8.2173e-63   1.9066e-63  -2.3181e-67
        -3.1520e-67  -1.4250e-70   5.2046e-71   5.2636e-74  -8.5844e-75
        -1.3386e-77   1.4144e-78   2.9686e-81  -2.3281e-82  -6.1283e-85
        3.8281e-86   1.2105e-88  -6.2888e-90  -2.3207e-92   1.0322e-93
        4.3543e-96  -1.6925e-97 -8.0376e-100  2.7727e-101  1.4649e-103
        -4.5382e-105 -2.6428e-107  7.4212e-109  4.7279e-111 -1.2125e-112
        -8.3993e-115""".split()
    ]
)


fcfs_nu8 = FCFs(
    mulliken_id=8,
    irrep=Irrep(letter='a', subscript='1'),
    nu_cm=1052,
    dQ=0.0010,
    fcfs=[
        abs(float(fcf)) for fcf in 
        """9.9999e-01  -3.9063e-03   1.8557e-04  -1.2069e-06   4.2082e-08
        -3.4035e-10   1.0038e-11  -9.2709e-14   2.4491e-15  -2.4794e-17
        6.0493e-19  -6.5559e-21   1.5055e-22  -1.7200e-24   3.7656e-26
        -4.4873e-28   9.4506e-30  -1.1656e-31   2.3775e-33  -3.0173e-35
        5.9915e-37  -7.7893e-39   1.5118e-40  -2.0062e-42   3.8182e-44
        -5.1570e-46   9.6497e-48  -1.3234e-49   2.4399e-51  -3.3914e-53
        6.1716e-55  -8.6796e-57   1.5614e-58  -2.2188e-60   3.9510e-62
        -5.6665e-64   9.9984e-66  -1.4458e-67   2.5303e-69  -3.6859e-71
        6.4034e-73  -9.3898e-75   1.6204e-76  -2.3904e-78   4.1004e-80
        -6.0813e-82   1.0375e-83  -1.5462e-85   2.6248e-87  -3.9293e-89
        6.6399e-91  -9.9799e-93   1.6795e-94  -2.5336e-96   4.2474e-98
        -6.4291e-100  1.0740e-101 -1.6307e-103  2.7154e-105 -4.1346e-107
        6.8644e-109""".split()
    ]
)


fcfs_nu7 = FCFs(
    mulliken_id=7,
    irrep=Irrep(letter='a', subscript='1'),
    nu_cm=1182,
    dQ=0.0025,
    fcfs=[
        abs(float(fcf)) for fcf in 
        """9.9995e-01  -1.0421e-02   4.1789e-04  -6.6193e-06   2.0908e-07
        -3.8305e-09   1.0837e-10  -2.1377e-12   5.6778e-14  -1.1695e-15
        2.9838e-17  -6.3167e-19   1.5682e-20  -3.3809e-22   8.2314e-24
        -1.7972e-25   4.3130e-27  -9.5009e-29   2.2554e-30  -5.0002e-32
        1.1770e-33  -2.6217e-35   6.1297e-37  -1.3701e-38   3.1862e-40
        -7.1400e-42   1.6531e-43  -3.7115e-45   8.5619e-47  -1.9250e-48
        4.4272e-50  -9.9639e-52   2.2856e-53  -5.1479e-55   1.1783e-56
        -2.6552e-58   6.0656e-60  -1.3674e-61   3.1185e-63  -7.0315e-65
        1.6013e-66  -3.6110e-68   8.2129e-70  -1.8521e-71   4.2076e-73
        -9.4885e-75   2.1534e-76  -4.8556e-78   1.1010e-79  -2.4823e-81
        5.6235e-83  -1.2677e-84   2.8698e-86  -6.4683e-88   1.4633e-89
        -3.2975e-91   7.4547e-93  -1.6796e-94   3.7949e-96  -8.5483e-98
        1.9303e-99""".split()
    ]
)


fcfs_nu6 = FCFs(
    mulliken_id=6,
    irrep=Irrep(letter='a', subscript='1'),
    nu_cm=1349,
    dQ=0.0082,
    fcfs= [
        abs(float(fcf)) for fcf in 
        """9.9933e-01  -3.6377e-02   3.2323e-03  -1.6443e-04   1.2088e-05
        -6.7465e-07 4.5879e-08  -2.6607e-09   1.7368e-10  -1.0258e-11
        6.5345e-13 -3.8950e-14 2.4421e-15  -1.4625e-16   9.0688e-18
        -5.4430e-19 3.3484e-20 -2.0113e-21 1.2299e-22  -7.3879e-24   4.4961e-25
        -2.6997e-26 1.6368e-27 -9.8214e-29 5.9360e-30  -3.5588e-31   2.1453e-32
        -1.2850e-33 7.7289e-35 -4.6250e-36 2.7764e-37  -1.6598e-38   9.9469e-40
        -5.9409e-41 3.5549e-42 -2.1213e-43 1.2676e-44  -7.5571e-46   4.5103e-47
        -2.6867e-48 1.6017e-49 -9.5328e-51 5.6772e-52  -3.3763e-53   2.0088e-54
        -1.1938e-55 7.0963e-57 -4.2140e-58 2.5030e-59  -1.4853e-60   8.8155e-62
        -5.2278e-63 3.1005e-64 -1.8375e-65 1.0891e-66  -6.4505e-68   3.8206e-69
        -2.2616e-70 1.3387e-71 -7.9202e-73 4.6855e-74""".split()
    ]
)


fcfs_nu5 = FCFs(
    mulliken_id=5,
    irrep=Irrep(letter='a', subscript='1'),
    nu_cm=1549,
    dQ=0.0031,
    fcfs=[
        abs(float(fcf)) for fcf in 
        """9.9989e-01  -1.4993e-02   7.2771e-04  -1.6147e-05   6.2801e-07
        -1.5829e-08   5.5806e-10  -1.4951e-11   4.9918e-13  -1.3834e-14
        4.4654e-16  -1.2629e-17   3.9858e-19  -1.1418e-20   3.5471e-22
        -1.0247e-23   3.1469e-25  -9.1409e-27   2.7831e-28  -8.1143e-30
        2.4541e-31  -7.1729e-33   2.1580e-34  -6.3179e-36   1.8928e-37
        -5.5471e-39   1.6561e-40  -4.8566e-42   1.4458e-43  -4.2413e-45
        1.2596e-46  -3.6955e-48   1.0952e-49  -3.2132e-51   9.5058e-53
        -2.7884e-54   8.2365e-56  -2.4156e-57   7.1253e-59  -2.0891e-60
        6.1548e-62  -1.8040e-63   5.3091e-65  -1.5556e-66   4.5735e-68
        -1.3396e-69   3.9349e-71  -1.1521e-72   3.3815e-74  -9.8969e-76
        2.9026e-77  -8.4921e-79   2.4889e-80  -7.2790e-82   2.1320e-83
        -6.2329e-85   1.8245e-86  -5.3320e-88   1.5599e-89  -4.5571e-91
        1.3325e-92""".split()
    ]
)


fcfs_nu4 = FCFs(
    mulliken_id=4,
    irrep=Irrep(letter='a', subscript='1'),
    nu_cm=1684,
    dQ=0.0017,
    fcfs=[
        abs(float(fcf)) for fcf in 
        """9.9996e-01  -8.3669e-03   2.5956e-04  -3.2834e-06   8.0517e-08
        -1.1738e-09   2.5845e-11  -4.0457e-13   8.3791e-15  -1.3669e-16
        2.7232e-18  -4.5587e-20   8.8468e-22  -1.5065e-23   2.8695e-25
        -4.9436e-27   9.2882e-29  -1.6133e-30   2.9998e-32  -5.2408e-34
        9.6666e-36  -1.6959e-37   3.1083e-39  -5.4698e-41   9.9739e-43
        -1.7591e-44   3.1942e-46  -5.6425e-48   1.0211e-49  -1.8058e-51
        3.2582e-53  -5.7670e-55   1.0380e-56  -1.8383e-58   3.3019e-60
        -5.8497e-62   1.0488e-63  -1.8585e-65   3.3267e-67  -5.8956e-69
        1.0539e-70  -1.8677e-72   3.3345e-74  -5.9092e-76   1.0538e-77
        -1.8673e-79   3.3269e-81  -5.8942e-83   1.0492e-84  -1.8585e-86
        3.3055e-88  -5.8542e-90   1.0405e-91  -1.8423e-93   3.2720e-95
        -5.7922e-97   1.0281e-98 -1.8195e-100  3.2277e-102 -5.7111e-104
        1.0126e-105""".split()
    ]
)


fcfs_nu3 = FCFs(
    mulliken_id=3,
    irrep=Irrep(letter='a', subscript='1'),
    nu_cm=3197,
    dQ=0.0001,
    fcfs=[
        abs(float(fcf)) for fcf in 
        """1.0000e+00  -4.6140e-04   1.6740e-05  -1.3298e-08   3.4320e-10
        -3.4987e-13   7.4164e-15  -8.8930e-18   1.6421e-19  -2.2197e-22
        3.6873e-24  -5.4783e-27   8.3557e-29  -1.3418e-31   1.9056e-33
        -3.2683e-36   4.3666e-38  -7.9277e-41   1.0042e-42  -1.9166e-45
        2.3162e-47  -4.6216e-50   5.3547e-52  -1.1120e-54   1.2403e-56
        -2.6706e-59   2.8776e-61  -6.4040e-64   6.6855e-66  -1.5336e-68
        1.5551e-70  -3.6685e-73   3.6209e-75  -8.7662e-78   8.4386e-80
        -2.0929e-82   1.9682e-84  -4.9928e-87   4.5940e-89  -1.1902e-91
        1.0729e-93  -2.8355e-96   2.5073e-98 -6.7510e-101  5.8623e-103
        -1.6065e-105  1.3713e-107 -3.8211e-110  3.2090e-112 -9.0845e-115
        7.5124e-117 -2.1589e-119  1.7593e-121 -5.1286e-124  4.1214e-126
        -1.2179e-128  9.6578e-131 -2.8912e-133  2.2638e-135 -6.8615e-138
        5.3075e-140""".split()
    ]
)


fcfs_nu2 = FCFs(
    mulliken_id=2,
    irrep=Irrep(letter='a', subscript='1'),
    nu_cm=3216,
    dQ=0.0001,
    fcfs=[
        abs(float(fcf)) for fcf in 
        """1.0000e+00  -6.9886e-04   8.7201e-05  -1.0527e-07   9.3128e-09
        -1.4477e-11   1.0484e-12  -1.9232e-15   1.2093e-16  -2.5089e-19
        1.4147e-20  -3.2364e-23   1.6703e-24  -4.1432e-27   1.9848e-28
        -5.2747e-31   2.3698e-32  -6.6873e-35   2.8398e-36  -8.4503e-39
        3.4131e-40  -1.0650e-42   4.1118e-44  -1.3393e-46   4.9634e-48
        -1.6813e-50   6.0013e-52  -2.1072e-54   7.2665e-56  -2.6377e-58
        8.8093e-60  -3.2978e-62   1.0691e-63  -4.1189e-66   1.2987e-67
        -5.1400e-70   1.5789e-71  -6.4090e-74   1.9209e-75  -7.9857e-78
        2.3386e-79  -9.9439e-82   2.8489e-83  -1.2375e-85   3.4724e-87
        -1.5392e-89   4.2345e-91  -1.9136e-93   5.1662e-95  -2.3780e-97
        6.3054e-99 -2.9539e-101  7.6989e-103 -3.6678e-105  9.4036e-107
        -4.5527e-109  1.1490e-110 -5.6493e-113  1.4042e-114 -7.0079e-117
        1.7168e-118""".split()
    ]
)


fcfs_nu1 = FCFs(
    mulliken_id=1,
    irrep=Irrep(letter='a', subscript='1'),
    nu_cm=3235,
    dQ=0.0001,
    fcfs=[
        abs(float(fcf)) for fcf in 
        """1.0000e+00  -7.6536e-04   4.7409e-05  -6.2481e-08   2.7526e-09
        -4.6563e-12   1.6845e-13  -3.3523e-16   1.0563e-17  -2.3700e-20
        6.7174e-22  -1.6568e-24   4.3109e-26  -1.1495e-28   2.7843e-30
        -7.9305e-33   1.8069e-34  -5.4487e-37   1.1769e-38  -3.7313e-41
        7.6873e-43  -2.5484e-45   5.0331e-47  -1.7368e-49   3.3017e-51
        -1.1815e-53   2.1695e-55  -8.0250e-58   1.4275e-59  -5.4436e-62
        9.4035e-64  -3.6882e-66   6.2011e-68  -2.4964e-70   4.0930e-72
        -1.6882e-74   2.7037e-76  -1.1407e-78   1.7872e-80  -7.7025e-83
        1.1822e-84  -5.1976e-87   7.8241e-89  -3.5053e-91   5.1809e-93
        -2.3627e-95   3.4323e-97  -1.5918e-99  2.2748e-101 -1.0719e-103
        1.5083e-105 -7.2155e-108  1.0004e-109 -4.8551e-112  6.6371e-114
        -3.2658e-116  4.4049e-118 -2.1960e-120  2.9242e-122 -1.4762e-124
        1.9418e-126""".split()
    ]
)


def show_fcfs(ax: Axes, mode: FCFs) -> None:
    fcfs = mode.fcfs
    xs = range(len(fcfs))
    label = (
        fr"$\nu _{{{mode.mulliken_id}}}"
        r"=" 
        fr"{mode.nu_cm:.0f}$"
        r"cm$^{-1}$" 
        r", $\Delta Q=" 
        fr"{mode.dQ:.4f}$"
    )
        # fr"(${mode.irrep.letter}_{{{mode.irrep.subscript}}}$)"
    ax.semilogy(xs, fcfs, label=label)


def main():
    ratio=16/9
    width=5.25
    fig = plt.figure(
        layout='constrained',
        figsize=(ratio*width,width),
    )
    ax = fig.subplots()
    show_fcfs(ax=ax, mode=fcfs_nu12,)
    show_fcfs(ax=ax, mode=fcfs_nu11,)
    show_fcfs(ax=ax, mode=fcfs_nu10,)
    show_fcfs(ax=ax, mode=fcfs_nu9,)
    show_fcfs(ax=ax, mode=fcfs_nu8,)
    show_fcfs(ax=ax, mode=fcfs_nu7,)
    show_fcfs(ax=ax, mode=fcfs_nu6,)
    show_fcfs(ax=ax, mode=fcfs_nu5,)
    show_fcfs(ax=ax, mode=fcfs_nu4,)
    show_fcfs(ax=ax, mode=fcfs_nu3,)
    show_fcfs(ax=ax, mode=fcfs_nu2,)
    show_fcfs(ax=ax, mode=fcfs_nu1,)
    ax.set_ylabel(r'$|\langle 0_{C}| n_{X} \rangle |$')
    ax.set_xlabel(r'$n_X$')
    ax.set_title("SrOPh X-C")
    ax.set_ylim(top=1, bottom=1e-100)
    ax.legend()
    ax.grid()
    fig.savefig(fname='fcfs_all_xc.svg')

if __name__ == "__main__":
    main()
